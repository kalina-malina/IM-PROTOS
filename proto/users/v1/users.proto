syntax = "proto3";

package users.v1;

option go_package = "github.com/kalina-malina/IM-PROTOS/generated/users/v1";
import "google/protobuf/empty.proto";


service UsersService {
  // доступно пользователям всем
  rpc UpdateUserProfile(UpdateUserProfileRequest) returns (UpdateUserProfileResponse);
  // доступно только администратору
  rpc GetAllUsers(GetAllUsersRequest) returns (GetAllUsersResponse);
  rpc ChangeUserRole(ChangeUserRoleRequest) returns (ChangeUserRoleResponse);
  rpc BanUser(BanUserRequest) returns (BanUserResponse);
  rpc UnbanUser(UnbanUserRequest) returns (UnbanUserResponse);
  //rpc UpdateUser(UpdateUserRequest) returns (UpdateUserResponse);
  //rpc LockUser(LockUserRequest) returns (LockUserResponse);
  //
  //rpc UpdateUserSettings(UpdateUserSettingsRequest) returns (UpdateUserSettingsResponse);
  
}

////////////////////////////////////////////////////////////
//доступно пользователям всем
message UpdateUserProfileRequest {
  optional uint64 id = 1;
  optional string first_name = 2;
  optional string last_name = 3;
  optional string date_of_birth = 4;
  optional string email = 5;
  repeated Childrens childrens = 6;
}

message UpdateUserProfileResponse {
  string first_name = 1;
  string last_name = 2;
  string date_of_birth = 3;
  string email = 4;
  repeated Childrens childrens = 5;
}


////////////////////////////////////////////////////////////
//доступно только администратору

//получение всех пользователей
message GetAllUsersRequest {
  repeated uint64 guid = 1;
  repeated uint64 card_number = 2;
  repeated string email = 3;
  repeated string first_name = 4;
  repeated string last_name = 5;
  repeated string date_of_birth = 6;
  repeated Role role = 7;
  repeated ABTestGroup ab_test_group = 8;
  string last_login = 9;
  string created_at = 10;
  uint64 page = 11;
  uint64 limit = 12;
}

message GetAllUsersResponse {
  repeated User users = 1;
}

//изменение роли пользователя
message ChangeUserRoleRequest {
  uint64 id_user = 1;
  Role role = 2;
}

message ChangeUserRoleResponse {
  string success = 1;
}

//Блокировка пользователя
message BanUserRequest {
  uint64 id_user = 1;
  BanReasonTypeEnum reason = 2;
  optional string reason_description = 3;
}

message BanUserResponse {
  bool success = 1;
}
//разблокирока пользовательй
message UnbanUserRequest {
  uint64 id_user = 1;
  string reason = 2;
}

message UnbanUserResponse {
  bool success = 1;
}

////////////////////////////////////////////////////////////
//общее
message User{
  uint64 id = 1;
  bool deleted = 2;
  Role role = 3;
  string first_name = 4;
  string last_name = 5;
  string date_of_birth = 6;
  uint64 card_number = 7;
  uint64 phone = 8;
  string email = 9;
  string last_coment_delivery = 10;
  bool  full_blocked = 11;
  uint32 selected_store_id = 12;
  repeated Childrens children = 13;
  ABTestGroup ab_test_group = 14;
}


message Childrens {
  string name = 1;
  string first_name = 2;
  string last_name = 3;
  string date_of_birth = 4;
  string mail = 5;
}

message UserSettings {
  bool push_notifications = 1;        // Push уведомления
  bool email_notifications = 2;       // Email уведомления
  bool sms_notifications = 3;         // SMS уведомления
  bool marketing_emails = 4;          // Маркетинговые рассылки
  bool marketing_sms = 5;             // Маркетинговые SMS
  bool order_updates = 6;             // Уведомления о заказах
  bool promotional_offers = 7;        // Промо-акции
  optional uint32 last_selected_store_id = 8; // Последний выбранный магазин
}



enum ReasonTypeEnum {
  // не понравился продукт и услуга
  REASON_NOT_LIKED_PRODUCT = 0;
  // не понравился сервис и обслуживание
  REASON_NOT_LIKED_SERVICE = 1;
  // долгая доставка
  REASON_LONG_DELIVERY = 2;
  // не понравился качество и обслуживание
  REASON_NOT_LIKED_QUALITY_AND_SERVICE = 3;
  // не понравился персонал  
  REASON_NOT_LIKED_PERSONAL = 4;
  // не понравился местоположение
  REASON_NOT_LIKED_LOCATION = 5;
  // не понравился время работы
  REASON_NOT_LIKED_TIME = 6;
  // не понравился цена
  REASON_NOT_LIKED_PRICE = 7;
  // другое
  REASON_OTHER = 8;
}

enum BanReasonTypeEnum {
  //не пристойное поведение
  BAN_REASON_UNPROPER_BEHAVIOR = 0;
  //спам
  BAN_REASON_SPAM = 1;
  //нарушение правил
  BAN_REASON_VIOLATION_OF_RULES = 2;
  //другое
  BAN_REASON_OTHER = 3;
}


enum Role {
  ROLE_CLIENT = 0;
  ROLE_ADMIN = 1;
  ROLE_OPERATOR = 2;
  ROLE_MARKETING = 3;
  ROLE_SUPPORT = 4;
  ROLE_MANAGEMENT = 5;
}

enum ABTestGroup {
  AB_TEST_GROUP_A = 0;
  AB_TEST_GROUP_B = 1;
  AB_TEST_GROUP_C = 2;
  AB_TEST_GROUP_D = 3;
}

