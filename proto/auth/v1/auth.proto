syntax = "proto3";

package auth.v1;

option go_package = "github.com/kalina-malina/IM-PROTOS/generated/auth/v1";
import "users/v1/users.proto"; 
import "google/protobuf/empty.proto";

service AuthOrRegistrationService {
  rpc LoginUsers(LoginUsersRequest) returns (LoginUsersResponse);
  rpc VerifySmsCode(VerifySmsCodeRequest) returns (VerifySmsCodeResponse);
  rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse);
  rpc Logout(google.protobuf.Empty) returns (LogoutResponse);
  rpc SelfLocking(google.protobuf.Empty) returns (SelfLockingResponse);
}


message LoginUsersRequest {
  uint64 phone_number = 1;
  TypeLogin type_login = 2;
}

message LoginUsersResponse {
  bool security = 1;
   bool is_new_user = 2;
   string verification_id  = 3;
}


message VerifySmsCodeRequest {
  optional string verification_id = 1;
  optional uint32 code = 2;
}

message VerifySmsCodeResponse {
  bool is_verified = 1;
  bool is_new_user = 2;
  string access_token = 3;
  string session_id = 4;
  optional users.v1.User user = 5;
}

message RefreshTokenRequest {
  string session_id = 2;
}

message RefreshTokenResponse {
  string access_token = 1;
  string session_id = 2;
}


message LogoutResponse {
  bool security = 1;
}
message SelfLockingResponse {
  bool success = 1;
}


enum TypeLogin {
  TYPE_LOGIN_SMS = 0;
  TYPE_LOGIN_YANDEX = 1;
}